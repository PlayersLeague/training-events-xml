<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Training Events</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: #f5f5f5;
            margin: 0;
            padding: 20px;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .event-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 300px;
        }

        .event-card h3 {
            margin-top: 0;
            color: #f89728;
        }

        .label {
            font-weight: bold;
            color: #005695;
        }

        .trainees {
            margin-top: 10px;
            font-style: italic;
        }
    </style>
</head>

<body>
    <h1>Training Events</h1>
    <div class="container" id="eventContainer"></div>

    
  <div id="eventContainer"></div>

  <script>
    fetch('https://playersleague.github.io/training-events-xml/training-events.xml')
      .then(res => res.text())
      .then(xmlText => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xmlText, "text/xml");
        const texts = xmlDoc.getElementsByTagName("text");

        const events = [];
        let currentEvent = null;
        let collectTrainees = false;

        Array.from(texts).forEach(text => {
          const key = text.querySelector("reportElement")?.getAttribute("key") || "";
          const content = text.querySelector("textContent")?.textContent?.trim();

          if (!content) return;

          if (key === "Resource FirstName Name") {
            if (currentEvent) events.push(currentEvent);
            currentEvent = {
              ResourceFirstNameName: content,
              EventStart: "",
              EventEnd: "",
              Instructor: "",
              EventLocation: "",
              EventName : "",
              Trainees: []
            };
            collectTrainees = true;
          }

          if (!currentEvent) return;

          if (key === "Schedule Event Start") currentEvent.EventStart = content;
          if (key === "Schedule Event End") currentEvent.EventEnd = content;
          if (key === "Instructor") currentEvent.Instructor = content;
          if (key === "EventLocation") currentEvent.EventLocation = content;
          if (key === "Schedule Event Name") currentEvent.EventName = content;

          if (key === "" && content !== "Trainee" && collectTrainees) {
            currentEvent.Trainees.push(content);
          }
        });

        if (currentEvent) events.push(currentEvent);

        // Render the cards
        const container = document.getElementById("eventContainer");
        events.forEach(event => {
          const card = document.createElement("div");
          card.className = "event-card";
          card.innerHTML = `
            <h3>${event.EventName}</h3>
            <p><span class="label">Resource:</span> ${event.ResourceFirstNameName}</p>
            <p><span class="label">Instructor:</span> ${event.Instructor}</p>
            <p><span class="label">Location:</span> ${event.EventLocation}</p>
            <p><span class="label">Time:</span> ${event.EventStart} - ${event.EventEnd}</p>
            <p><span class="label">Trainees:</span><br> ${event.Trainees.map(t => `- ${t}`).join("<br>")}</p>
          `;
          container.appendChild(card);
        });
      })
      .catch(err => console.error("Error parsing XML:", err));
  </script>
</body>
</html>
